$(document).ready(function(){function a(){var a,t=new Date,e=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),i=t.getMinutes(),o=t.getSeconds(),d=t.getHours();d>12?d-=12:0===d&&(d=12);1==r.toString().length&&(r="0"+r);1==n.toString().length&&(n="0"+n);1==d.toString().length&&(d="0"+d);1==i.toString().length&&(i="0"+i);1==o.toString().length&&(o="0"+o);a=e+"-"+r+"-"+n+" "+d+":"+i+":"+o;return a}$(".global-message").on("click",".param-confirmation-btn",function(){var a=$(this).attr("tank_id"),t=$(this).attr("param_id"),e=$(this).attr("nonce"),r=$(this).attr("parent").parent=$("."+r);data={action:"del_tank_params",ajax_form_nonce_del_param:e,tank_id:a,param_id:t};$.ajax({url:ajaxurl,method:"post",data:data,success:function(a){$(".removeParam").remove();closeGlobalMessage()},error:function(a){}})});var t=function a(t){var e=decodeURIComponent(window.location.search.substring(1)),r=e.split("&"),n,i;for(i=0;i<r.length;i++){n=r[i].split("=");if(n[0]===t)return void 0===n[1]||n[1]}};$(".param-filters").click(function(){var a,e,r,n,i;a=$("#datepicker-from").datepicker("option","dateFormat","yy-mm-dd").val();e=$("#datepicker-to").datepicker("option","dateFormat","yy-mm-dd").val();r=t("tank_id");n="/paramque?"+"tank_id="+r+"&date_start="+a+"&date_end="+e;i=$(this).attr("value");$.ajax({url:"/paramque?"+"tank_id="+r+"&date_start="+a+"&date_end="+e,success:function(a){$(".parameter_overview").html(a)}})});$(".param-table-filters").click(function(){var a=$("#datepicker-from").datepicker("option","dateFormat","yy-mm-dd").val(),e=$("#datepicker-to").datepicker("option","dateFormat","yy-mm-dd").val(),r=t("tank_id");$.ajax({url:"/paramtableque?"+"tank_id="+r+"&date_start="+a+"&date_end="+e,success:function(a){$(".params").html(a)}})});$(".param-table").on("click",".del-param-input",function(){var a=$(this).attr("tank_id"),t=$(this).attr("param_id"),e=$(this).attr("nonce");$(this).parent().parent().addClass("removeParam");$(".global-message .message").text("Are you sure you want to delete this entry?");$(".confirmation-btn").attr("param_id",t);$(".confirmation-btn").attr("tank_id",a);$(".confirmation-btn").attr("nonce",e);$(".confirmation-btn").attr("parent",parent);$(".confirmation-btn").addClass("param-confirmation-btn");$(".message-action").addClass("param-message-action");$(".global-message").fadeToggle();$(".overlay").fadeToggle()});$(".param-table").on("click",".edit-param-input",function(){var a=$(this).parent().parent();a.find(".param_value").attr("contenteditable","true");a.find(".param_value").addClass("editable");a.find(".save-btn").removeClass("hide");a.find(".edit-btn").addClass("hide");a.toggleClass("edited-row")});$(".param-table").on("click",".save-param-input",function(){var t=$(this).attr("tank_id"),e=$(this).attr("nonce"),r=$(this).attr("param_id"),n=$(this).parent().parent(),i=n.find(".param_type").val(),o=n.find(".param_value").val(),d=n.find(".param_value").text(),s=n.hasClass("edited-row"),l=0;if("Parameter"==i&&0==s){n.find(".param_type").parent().addClass("error-cell");l=0}else l++;if($.isNumeric(o)||0!=s)l++;else{n.find(".param_value").parent().addClass("error-cell");l=0}if(1==s){data={action:"save_tank_params",ajax_form_nonce_save_param:e,tank_id:t,param_id:r,value:d};n.find(".param_value").attr("contenteditable","false");n.find(".param_value").removeClass("editable");n.find(".save-btn").addClass("hide");n.find(".edit-btn").removeClass("hide");n.toggleClass("edited-row")}else data={action:"new_tank_params",ajax_form_nonce_save_param:e,tank_id:t,type:i,value:o};if(2!=l){$(".global-error").html("Please enter a parameter type and or correct parameter value.");$(".global-error").addClass("show");setTimeout(function(){$(".global-error").removeClass("show")},2e3)}else{n.find(".date_logged").html(a);n.find(".param_type").parent().removeClass("error-cell");n.find(".param_value").parent().removeClass("error-cell");$.ajax({url:ajaxurl,method:"post",data:data,success:function(a){var t,e;if("0"!=a){$(".new-input .save-btn a").attr("param_id",a);$(".new-input .edit-btn a").attr("param_id",a);$(".new-input .del-btn a").attr("param_id",a);t=$(".input-row").find(".param_value").val();$(".input-row").find(".param_value").parent().addClass("param_value");$(".input-row").find("input.param_value").remove();$(".input-row").find(".param_value").text(t);e=$(".input-row").find(".param_type").find("option:selected").attr("name");$(".input-row").find(".param_type").parent().addClass("param_type");$(".input-row").find("select.param_type").remove();$(".input-row").find(".param_type").text(e);$(".input-row").removeClass("new-input");$(".input-row").find(".save-btn").addClass("hide");$(".input-row").removeClass("input-row");$("tbody tr").first().next().before(inputRow)}},error:function(a){}})}})});